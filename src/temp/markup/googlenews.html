<!DOCTYPE html>
<html>

<head>
	<meta charset='utf-8'>
	<title>Google News</title>
	<meta name='viewport' content='width=device-width, initial-scale=1.0'>

	<script src="//code.jquery.com/jquery.min.js"></script>
	<script src='//cdnjs.cloudflare.com/ajax/libs/handlebars.js/2.0.0/handlebars.min.js'>
	</script>

	<style type='text/css'>
		/* resets */

		html {
			box-sizing: border-box;
		}

		*, *:before, *:after {
			margin: 0;
			padding: 0;
			border: 0;
			box-sizing: inherit;
		}

		/* Responsive design, smallest device first */
		body {
			margin-top: 1em;
		}

		.clearboth {
			clear: both;
		}

		.date {
			float: left;
			font-size: 70%;
		}

		.author {
			float: right;
			font-size: 70%;
		}

		.gray {
			color: gray;
		}

		#rendered {
			margin: 0 auto;
		}


			#rendered ul {
				list-style-type: none;
			}

			#rendered li {
				list-style-type: none;
				border: 1px solid black;
				border-radius: 0.5em;
				display: block;
				margin: 1em 0.5em 1em 0.5em;
			}

				#rendered li a {
					display: block;
					padding: 0.5em;
				}

		a:link, a:visited, a:hover, a:active {
			text-decoration: none;
		}

		#rendered h3 {
			text-align: center;
		}

			#rendered h3:after {
				content: " - Phone";
			}

		@media (min-width: 480px) {

			#rendered h3:after {
				content: " - Phone large";
			}

			#rendered {
				font-size: 110%;
			}
		}

		@media (min-width: 768px) {
			#rendered h3:after {
				content: " - Tablet";
			}

			#rendered {
				width: 90%;
				font-size: 120%;
			}
		}

		@media (min-width: 992px) {
			#rendered h3:after {
				content: " - Desktop";
			}

			#rendered {
				font-size: 130%;
			}
		}

		@media (min-width: 1200px) {
			#rendered h3:after {
				content: " - Desktop large";
			}

			#rendered {
				font-size: 140%;
			}
		}
	</style>
</head>

<body>
	<section id='rendered'></section>
	<script id="template" type="text/x-handlebars-template">
		<h3>News</h3>
		<ul>
			{{#entries}}
			<li>
				<a href='{{link}}' target='_blank'>
					<div class='date gray'>{{publishedDate}}</div>
					<div class='author gray'>{{authorFormatted author}}</div>
					<div class='clearboth'></div>
					<div>{{title}}</div>
					<div class='gray'>Categories: {{categoryList categories}}</div>
				</a>
			</li>
			{{/entries}}
		</ul>
	</script>


	<script>
		 !function (d, $) {
            // Aggregate string array to string
			Handlebars.registerHelper('categoryList', function (categories) {
				if (!categories) return '';
				if (categories.length === 1) return categories[0];

				return categories.reduce(function (a, b) {
					return a + b + ', ';
				}, '');
			});

            // Format author data
			Handlebars.registerHelper('authorFormatted', function (author) {
				if (!author) return '- Unknown author';
				return '- ' + author
			});

            // Json url
			var url = '//ajax.googleapis.com/ajax/services/feed/load?v=1.0';
			url += '&num=10&q=http://news.google.com/news?output=rss';

            // Get json data from Google
			$.ajax({
				url: url,
				type: 'GET',
                // avoid having no CORS policy by using jsonp
				dataType: 'jsonp', 
				success: function (result) {                  
					data = result; // save to global var for debugging

                    // If download was success, then apply rendering
					if (result.responseStatus === 200) {
						var templateSource = $('#template').html();
						var template = Handlebars.compile(templateSource);
						var html = template(result.responseData.feed);
						$('#rendered').append(html);
					}
				},
				error: function (result) {
					console.log(result);
					$('#rendered').append('ERROR - ' + JSON.stringify(result));
				}
			});
		}(document, jQuery);
	</script>
</body>

</html>
